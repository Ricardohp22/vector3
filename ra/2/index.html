<!doctype HTML>
<html>

<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <!--<script async src="https://www.googletagmanager.com/gtag/js?id=UA-136675623-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-136675623-1');
    </script>-->
    
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
</head>
<script src="https://aframe.io/releases/0.8.0/aframe.min.js"></script>
<script src="https://rawgit.com/jeromeetienne/AR.js/master/aframe/build/aframe-ar.min.js"></script>
<script src="https://rawgit.com/donmccurdy/aframe-extras/master/dist/aframe-extras.loaders.min.js"></script>
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script>
    var isTargetFound = false;
      var interacted = false;
    var cuenta2 = 0;
      AFRAME.registerComponent("markerhandler",{
              init:function() {
                  console.log('markerhandler-init');

                 markerObj = document.querySelector('a-marker');
                 markerObj.hidden = true;

                 //dino.setAttribute('animation-mixer', {clip: 'C4D Animation Take', loop: 'repeat'});
              },

              tick:function() {

                  if (markerObj != null)
                      {
                          if (markerObj.object3D.visible == true) {
                              
                            if (isTargetFound)
                              return;

                            isTargetFound = true;
                            console.log ("marker visible");
                            cuenta2++;
                            if(cuenta2==1)
                            {
                              window.setTimeout(function(e){
                                document.getElementById("btn1").emit("start");
                              },1000);
                              window.setTimeout(function(e){
                                document.getElementById("btn2").emit("start");
                              },1500);
                              window.setTimeout(function(e){
                                document.getElementById("btn3").emit("start");
                              },2000);
                              window.setTimeout(function(e){
                                document.getElementById("btn4").emit("start");
                              },2500);
                              
                            }
                            window.reproducir();
                            //window.pausar();
                            //document.getElementById("videoScene").emit("an1");
                          }
                          else {
                              
                            if (!isTargetFound)
                              return;

                            isTargetFound = false;
                          console.log ("marker invisible");
                          window.pausar();
                          }
                        }
                }
              });
  </script>

<body style='margin : 0px; overflow: hidden;' id="cuerpo">
    <!-- we add detectionMode and matrixCodeType to tell AR.js to recognize barcode markers -->
    <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false; patternRatio: 0.8;">
            <a-assets>
                    <!--<video id="video"  src="video/video.mp4"></video>-->
                    <video id="video" width="320" height="180" controls>
                        <source src="video/promoSociosTarjetas320x180.mp4" type="video/mp4">
                    </video>
                        
                </a-assets>
        <a-marker markerhandler emitevents="true" cursor="fuse: false; rayOrigin: mouse" type="pattern" url="pattern-ra-2.patt">

            <a-video id="videoScene" position="0 0 0" src="#video" width="3" height="1.5" position="0 0 0" rotation="-90 0 0" opacity="1"></a-video>
            <a-plane id="btn1" position="-1.2 0 1" rotation="-90 0 0" width=".4" height=".4" material="src:images/1.png" opacity="0">
                <a-animation
                    attribute="opacity"
                    begin="start"
                    dur="500"
                    to=".9"
                    easing="linear"
                ></a-animation>
                <a-animation
                    attribute="rotation"
                    begin="start"
                    dur="1000"
                    to="-90 0 360"
                ></a-animation>
                <a-animation
                    attribute="rotation"
                    begin="5000"
                    dur="1000"
                    to="-90 0 360"
                    repeat="indefinite"
                ></a-animation>
            </a-plane>

            <a-plane id="btn2" position="-.5 0 1" rotation="-90 0 0" width=".4" height=".4" material="src:images/2.png" opacity="0">
                <a-animation
                    attribute="opacity"
                    begin="start"
                    dur="500"
                    to=".9"
                    easing="linear"
                ></a-animation>
                <a-animation
                    attribute="rotation"
                    begin="start"
                    dur="1000"
                    to="-90 0 360"
                ></a-animation>
                <a-animation
                    attribute="rotation"
                    begin="5500"
                    dur="1000"
                    to="-90 0 360"
                    repeat="indefinite"
                ></a-animation>
            </a-plane>
            <a-plane id="btn3" position=".2 0 1" rotation="-90 0 0" width=".4" height=".4" material="src:images/3.png" opacity="0">
                <a-animation
                    attribute="opacity"
                    begin="start"
                    dur="500"
                    to=".9"
                    easing="linear"
                ></a-animation>
                <a-animation
                    attribute="rotation"
                    begin="start"
                    dur="1000"
                    to="-90 0 360"
                ></a-animation>
                <a-animation
                    attribute="rotation"
                    begin="6000"
                    dur="1000"
                    to="-90 0 360"
                    repeat="indefinite"
                ></a-animation>
            </a-plane>
            <a-plane id="btn4" position=".9 0 1" rotation="-90 0 0" width=".4" height=".4" material="src:images/4.png" opacity="0">
                <a-animation
                    attribute="opacity"
                    begin="start"
                    dur="500"
                    to=".9"
                    easing="linear"
                ></a-animation>
                <a-animation
                    attribute="rotation"
                    begin="start"
                    dur="1000"
                    to="-90 0 360"
                ></a-animation>
                <a-animation
                    attribute="rotation"
                    begin="6500"
                    dur="1000"
                    to="-90 0 360"
                    repeat="indefinite"
                ></a-animation>
            </a-plane>
            <!--Planos clickables-->
            <a-plane id="clk1" position="-25.9 .02 1" rotation="-90 0 0" width="50" height="1" opacity="0"></a-plane>
            <a-plane id="clk4" position="26 .02 1" rotation="-90 0 0" width="50" height="1" opacity="0"></a-plane>
            <a-plane id="clk2" position="-25.25 .01 1" rotation="-90 0 0" width="50" height="1" opacity="0" material="color:blue;"></a-plane>
            <a-plane id="clk3" position="24.95 .01 1" rotation="-90 0 0" width="50" height="1" opacity="0" material="color:blue;"></a-plane>
        </a-marker>

        <a-entity camera></a-entity>
    </a-scene>
</body>

<script>

    /**/
    window.reproducir = function() {
        document.getElementById("video").play();
    };

    window.pausar = function() {
        document.getElementById("video").pause();
    };
    var btn1 = document.getElementById("btn1");
    var btn2 = document.getElementById("btn2");
    var btn3 = document.getElementById("btn3");
    var btn4 = document.getElementById("btn4");

    var clk1 = document.getElementById("clk1");
    var clk2 = document.getElementById("clk2");
    var clk3 = document.getElementById("clk3");
    var clk4 = document.getElementById("clk4");

    clk1.addEventListener("click", function(e){
        window.open("https://api.whatsapp.com/send?phone=+5215583520531&text=Hola!%20en%20que%20podemos%20ayudarte?");
    });
    clk2.addEventListener("click", function(e){
        window.open("fb://page/100000931927523");
    });
    clk3.addEventListener("click", function(e){
        window.open("tel:5583520531");
    });
    clk4.addEventListener("click", function(e){
        window.open("https://www.miguelangelgutierrez.com.mx");
    });

    /*
    */
    btn1.addEventListener("click", function(e){
        alert("btn1");
    });
    btn2.addEventListener("click", function(e){
        alert("btn2");
    });
    btn3.addEventListener("click", function(e){
        alert("btn3");
    });
    btn4.addEventListener("click", function(e){
        window.open("tel:5583520531");
    });
    /**/
    


</script>

</html>